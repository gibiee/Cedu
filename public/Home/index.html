<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>교육용 한글 프로그래밍 언어</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="description" content="" />
  <meta name="keywords" content="" />

  <script src="../jquery-3.3.1.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" />
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="./login.css" />

  <!--[if lte IE 8]><script src="js/html5shiv.js"></script><![endif]-->
  <script src="./js/jquery.min.js"></script>
  <script src="./js/skel.min.js"></script>
  <script src="./js/skel-layers.min.js"></script>
  <script src="./js/init.js"></script>
  <noscript>
    <link rel="stylesheet" href="./css/skel.css" />
    <link rel="stylesheet" href="./css/style.css" />
    <link rel="stylesheet" href="./css/style-xlarge.css" />
  </noscript>
  <style>
    li {
      font-size:20px;
    }
    hr {
      border:0;
      height:5px;
      background:black;
    }
    iframe {
      height:90vh;
    }
  </style>
  <script>
    var id; //Coding-코드저장에 필요함!

    function logout() {
      var _logout = confirm("로그아웃 하시겠습니까?");
      if(_logout) {
        $.ajax({
          type: "POST",
          url: "/logout",
          success : function (data) {
            $("#로그인_menu").css('display', 'block');
            $("#로그인_상태").html('');
          }
        });
      }
      id = "익명";
    }

    $(document).ready( function () {
      $.ajax({  //평소에(기본으로) 아이디 받아오기
        type: "POST",
        url: "/",
        success : function (data) {
          id = data;
          if(id != "익명") {
            $("#로그인_menu").hide();
            $("#로그인_상태").html("<b>" + id + "</b>님 안녕하세요!&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"
            + "<a href='javascript:void(0);' onclick='logout();' style='font-size:16px'>로그아웃</a>");
          }
        }
      });

      $("#로그인_form").click( function () {
        $.ajax({
          type: "POST",
          url: "/login",
          data: $('#login_form').serialize(),
          success : function (data) {
            if(data == true) {
              id = $('#login_form').serializeArray()[0].value;
              alert("로그인 성공!");
              $("#로그인_menu").hide();
              $("#로그인_상태").html("<b>" + id + "</b>님 안녕하세요!&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"
              + "<a href='javascript:void(0);' onclick='logout();' style='font-size:16px'>로그아웃</a>");
              $("#login-modal").click();
            }
            else { alert(data); }
          },
        });
      });
    });

  </script>
</head>
<body style="overflow:hidden">
  <header id="header" class="skel-layers-fixed">
    <h1><a href="./Cedu_Home.html" target="home" style="font-size:30px">Cedu</a></h1>
    <nav id="nav">
      <ul>
        <li><a href="./Cedu_Home.html" target="home">소개</a></li>
        <li><a href="#" target="home">메뉴얼</a></li>
        <li><a href="../Coding/Cedu_Coding.html" target="home">코딩하기</a></li>
        <li><a href="../Problems/Cedu_List.html" target="home">문제풀기</a></li>
        <li><a href="#" target="home">커뮤니티</a></li>
        <li><a class="button special" data-toggle="modal" data-target="#login-modal" id="로그인_menu">로그인</a></li>
        <li><div id="로그인_상태"></div></li>
      </ul>
    </nav>
  </header>

  <br/>
  <iframe name="home" src = "./Cedu_Home.html" width="100%" frameborder=0></iframe>

  <!-- 로그인 화면 -->
  <div class="modal fade" id="login-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display:none;">
    <div class="modal-dialog">
      <div class="loginmodal-container">
        <br/><br/><h1>로그인</h1>
        <form id="login_form">
          <input type="text" name="id" placeholder="아이디"/>
          <input type="password" name="pwd" placeholder="비밀번호" />
          <input type="button" name="login" class="login loginmodal-submit" value="로그인" id="로그인_form" />
        </form>
        <div class="login-help">
          <a href="#">회원가입</a>
          <a href="#" style="float:right">비밀번호 찾기</a>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
